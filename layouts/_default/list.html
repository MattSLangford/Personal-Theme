{{ define "main" }}
<div class="list-page">
  <header class="list-header">
    <h1 class="list-title">
      {{ if .Title }}
        {{ .Title }}
      {{ else if eq .Section "posts" }}
        All Posts
      {{ else if eq .Section "categories" }}
        Categories
      {{ else if eq .Section "tags" }}
        Tags
      {{ else }}
        {{ .Section | title }}
      {{ end }}
    </h1>
    
    {{ if .Description }}
    <p class="list-description">{{ .Description }}</p>
    {{ end }}
    
    {{ if and .Pages (gt (len .Pages) 0) }}
    <div class="list-meta">
      {{ $count := len .Pages }}
      {{ if eq $count 1 }}
        1 post
      {{ else }}
        {{ $count }} posts
      {{ end }}
    </div>
    {{ end }}
  </header>

  {{ if eq .Section "categories" }}
    {{ if .Site.Taxonomies.categories }}
    <div class="category-list">
      {{ range $name, $taxonomy := .Site.Taxonomies.categories }}
      <a href="/categories/{{ $name | urlize }}" class="category-item">
        <div class="category-name">{{ $name }}</div>
        <div class="category-count">{{ len $taxonomy }} posts</div>
      </a>
      {{ end }}
    </div>
    {{ end }}
  {{ else if eq .Section "tags" }}
    {{ if .Site.Taxonomies.tags }}
    <div class="category-list">
      {{ range $name, $taxonomy := .Site.Taxonomies.tags }}
      <a href="/tags/{{ $name | urlize }}" class="category-item">
        <div class="category-name">{{ $name }}</div>
        <div class="category-count">{{ len $taxonomy }} posts</div>
      </a>
      {{ end }}
    </div>
    {{ end }}
  {{ else }}
    {{ if .Pages }}
    <div class="post-list">
      {{ range .Pages }}
      <article class="post-preview h-entry">
        <header class="post-header">
          {{ if .Date }}
          <time class="post-date u-url" datetime="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
            {{ .Date.Format "Jan 2, 2006" }}
          </time>
          {{ end }}
        </header>

        {{ if .Title }}
        <h2 class="post-title p-name">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h2>
        {{ end }}

        <div class="e-content">
          {{ if .Params.photos }}
            {{ if eq (len .Params.photos) 1 }}
              <img src="{{ index .Params.photos 0 }}" alt="">
            {{ else }}
              <div class="photos">
                {{ range .Params.photos }}
                  <img src="{{ . }}" alt="">
                {{ end }}
              </div>
            {{ end }}
          {{ end }}

          {{ if .Summary }}
            {{ .Summary }}
            {{ if .Truncated }}
              <p><a href="{{ .Permalink }}" class="read-more">Continue reading →</a></p>
            {{ end }}
          {{ else }}
            {{ .Content }}
          {{ end }}
        </div>
        
        {{ if .Params.categories }}
        <footer class="post-meta">
          <ul class="post-tags">
            {{ range .Params.categories }}
            {{ $href := print (absURL "categories/") (urlize .) }}
            <li><a href="{{ $href }}">{{ . }}</a></li>
            {{ end }}
          </ul>
        </footer>
        {{ end }}
      </article>
      {{ end }}
    </div>
    {{ else }}
    <div class="empty-state">
      <p>No posts found in this section.</p>
      <a href="/" class="button">← Back to Home</a>
    </div>
    {{ end }}
  {{ end }}

  {{ if .Paginator }}
  <nav class="post-nav" aria-label="Pagination Navigation">
    {{ if .Paginator.HasPrev }}
    <a href="{{ .Paginator.Prev.URL }}" class="prev" rel="prev">
      <span>← Previous</span>
    </a>
    {{ end }}

    {{ if .Paginator.HasNext }}
    <a href="{{ .Paginator.Next.URL }}" class="next" rel="next">
      <span>Next →</span>
    </a>
    {{ end }}
  </nav>
  {{ end }}
</div>
{{ end }}