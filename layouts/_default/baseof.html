<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang | default "en" }}">

{{ partial "head.html" . }}

<body>
  {{ partial "blog-header.html" . }}

  <main class="page-content" role="main">
    <div class="wrapper">
      {{ block "main" . }}{{ end }}
    </div>
  </main>

  {{ partial "footer.html" . }}

  {{ range .Site.Params.plugins_js }}
  <script src="{{ . }}" defer></script>
  {{ end }}
  
  <!-- Enhanced Performance Script -->
  <script>
    // Preload critical images on hover for instant navigation
    document.addEventListener('DOMContentLoaded', function() {
      const postLinks = document.querySelectorAll('.post-title a, .nav-item');
      postLinks.forEach(link => {
        link.addEventListener('mouseenter', function() {
          const url = this.href;
          if (url && !document.querySelector(`link[href="${url}"]`)) {
            const prefetch = document.createElement('link');
            prefetch.rel = 'prefetch';
            prefetch.href = url;
            document.head.appendChild(prefetch);
          }
        });
      });
      
      // Add loading class to images for progressive enhancement
      const images = document.querySelectorAll('img[src]');
      images.forEach(img => {
        if (!img.complete) {
          img.classList.add('loading');
          img.addEventListener('load', () => {
            img.classList.remove('loading');
          });
        }
      });
      
      // Smooth scroll polyfill for older browsers
      if (!('scrollBehavior' in document.documentElement.style)) {
        const links = document.querySelectorAll('a[href^="#"]');
        links.forEach(link => {
          link.addEventListener('click', function(e) {
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
              e.preventDefault();
              target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
              });
            }
          });
        });
      }
    });
  </script>
</body>
</html>